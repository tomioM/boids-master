<!DOCTYPE html>
<html>

<head>
  <meta charset="utf-8" />
  <title>Boids</title>
  <script src="./boids.js"></script>
  <script src="./print.js"></script>
  <style type="text/css">
    body {
      margin: 0;
      background: #ffffff;
      overflow: hidden;
    }
    svg {
      opacity: 50%;
      position: absolute;
      fill: none;
      stroke: black;
      /* padding: 5%; */
    }
    canvas {
      pointer-events: auto; /* or none, depending */

    }


      #controlPanel {
        /* transform: scale(3); */
/* transform-origin: top right; */
    position: fixed;
    top: 20px;
    right: 20px;
    background: #1a1a1a;
    color: white;
    font-family: sans-serif;
    padding: 10px;
    border-radius: 10px;
    font-size: 12px;
    z-index: 10000;
    width: 220px;
    cursor: move;
    box-shadow: 0 0 10px #00000088;
  }

  #controlPanel input,
  #controlPanel select {
    width: 100%;
    margin: 2px 0 8px;
    font-size: 12px;
    background: #333;
    color: white;
    border: none;
    padding: 4px;
    border-radius: 5px;
  }

  #controlPanel label {
    font-weight: bold;
    display: block;
    margin-top: 6px;
  }

  .section {
    margin-bottom: 12px;
    border-bottom: 1px solid #444;
    padding-bottom: 8px;
  }
  </style>
</head>

<body>

  <svg version="1.1" id="shapeSVG"  width="100%" height="100%" xmlns="http://www.w3.org/2000/svg" xml:space="preserve">
  <path id="boidPath" d=M1815.49,391.91c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-82.48v-47.48c0-9.95,1.3-19.58,3.92-28.88,2.61-9.3,6.24-18.03,10.89-26.19,4.65-8.16,10.03-15.62,16.15-22.39,6.12-6.77,12.73-12.56,19.82-17.38,7.1-4.81,14.44-8.57,22.02-11.26,7.59-2.69,15.05-4.04,22.39-4.04,8.97,0,17.54,2.2,25.7,6.61,4.73,2.78,8.85,2.94,12.36.49,3.51-2.45,6.4-6.61,8.69-12.48,2.28-6.03,2.77-11.09,1.47-15.17-1.31-4.08-4.33-7.5-9.06-10.28-11.1-6.52-23-9.79-35.73-9.79-9.3,0-18.68,1.68-28.14,5.02-9.46,3.35-18.6,8.12-27.41,14.32-8.81,6.2-17.09,13.7-24.84,22.51-7.75,8.81-14.64,18.68-20.68,29.61v-49.44c0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.33-3.67-11.87-3.67h-49.93c-5.55,0-9.51,1.22-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97s1.18,10.52,3.55,12.97c2.36,2.45,6.32,3.67,11.87,3.67h31.08v159.56h-38.42c-5.55,0-9.51,1.23-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97,0,1.95.13,3.69.36,5.27h-57.26c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-20.07v-176.21c0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-56.04c-5.55,0-9.51,1.22-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97s1.18,10.52,3.55,12.97c2.36,2.45,6.32,3.67,11.87,3.67h34.75v69.99c0,13.38-2.12,25.7-6.36,36.95-4.24,11.26-9.95,20.97-17.13,29.12-7.18,8.16-15.5,14.52-24.96,19.09-9.46,4.57-19.42,6.85-29.86,6.85-6.69,0-12.52-1.14-17.5-3.43-4.98-2.28-9.1-5.51-12.36-9.67-3.27-4.16-5.71-9.13-7.34-14.93-1.63-5.79-2.45-12.19-2.45-19.21v-131.42c0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-41.36c-5.55,0-9.51,1.22-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97s1.18,10.52,3.55,12.97c2.36,2.45,6.32,3.67,11.87,3.67h20.07v118.45c0,12.24,1.67,23.29,5.02,33.16,3.34,9.87,8.16,18.23,14.44,25.09,1.55,1.69,3.18,3.28,4.89,4.78h-71.45c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.33-3.67-11.87-3.67h-15.17v-132.64c0-11.26-1.34-21.01-4.03-29.25-2.7-8.24-6.33-15.05-10.89-20.44-4.57-5.38-9.91-9.38-16.03-11.99-6.12-2.61-12.69-3.92-19.7-3.92-11.26,0-21.62,3.63-31.08,10.89-9.46,7.26-17.87,18.4-25.21,33.41-1.47-7.5-3.71-14.03-6.73-19.58-3.02-5.54-6.57-10.16-10.65-13.83-4.08-3.67-8.53-6.4-13.34-8.2-4.81-1.79-9.91-2.69-15.3-2.69-11.26,0-21.78,3.76-31.57,11.26-9.79,7.51-18.27,19.17-25.45,35v-24.23c0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-36.47c-5.55,0-9.51,1.22-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97s1.18,10.52,3.55,12.97c2.36,2.45,6.32,3.67,11.87,3.67h20.07v159.56h-20.07c-5.55,0-9.51,1.23-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97,0,1.95.13,3.69.36,5.27h-75.86c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-82.48v-47.48c0-9.95,1.3-19.58,3.92-28.88,2.61-9.3,6.24-18.03,10.89-26.19,4.65-8.16,10.03-15.62,16.15-22.39,6.12-6.77,12.73-12.56,19.82-17.38,7.1-4.81,14.44-8.57,22.03-11.26,7.59-2.69,15.05-4.04,22.39-4.04,8.97,0,17.54,2.2,25.7,6.61,4.73,2.78,8.85,2.94,12.36.49,3.51-2.45,6.4-6.61,8.69-12.48,2.28-6.03,2.77-11.09,1.47-15.17-1.31-4.08-4.33-7.5-9.06-10.28-11.1-6.52-23-9.79-35.73-9.79-9.3,0-18.68,1.68-28.14,5.02-9.46,3.35-18.6,8.12-27.41,14.32-8.81,6.2-17.09,13.7-24.84,22.51-7.75,8.81-14.65,18.68-20.68,29.61v-49.44c0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-49.93c-5.55,0-9.51,1.22-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97s1.18,10.52,3.55,12.97c2.36,2.45,6.32,3.67,11.87,3.67h31.08v159.56h-38.42c-5.55,0-9.51,1.23-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97,0,1.95.13,3.69.36,5.27h-42.85V0h-2.32v391.91h-12.1c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.33-3.67-11.87-3.67h-20.07v-176.21c0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-56.04c-5.55,0-9.51,1.22-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97s1.18,10.52,3.55,12.97c2.36,2.45,6.32,3.67,11.87,3.67h34.75v69.99c0,13.38-2.12,25.7-6.36,36.95-4.25,11.26-9.95,20.97-17.13,29.12-7.18,8.16-15.5,14.52-24.96,19.09-9.46,4.57-19.42,6.85-29.86,6.85-6.69,0-12.52-1.14-17.5-3.43-4.98-2.28-9.1-5.51-12.36-9.67-3.27-4.16-5.71-9.13-7.34-14.93-1.63-5.79-2.45-12.19-2.45-19.21v-131.42c0-6.2-1.18-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-41.36c-5.55,0-9.51,1.22-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97s1.18,10.52,3.55,12.97c2.36,2.45,6.32,3.67,11.87,3.67h20.07v118.45c0,12.24,1.67,23.29,5.02,33.16,3.34,9.87,8.16,18.23,14.44,25.09,1.55,1.69,3.18,3.28,4.89,4.78h-71.46c.23-1.58.37-3.32.37-5.27,0-6.2-1.18-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-15.17v-132.64c0-11.26-1.35-21.01-4.04-29.25-2.69-8.24-6.32-15.05-10.89-20.44-4.57-5.38-9.91-9.38-16.03-11.99-6.12-2.61-12.69-3.92-19.7-3.92-11.26,0-21.62,3.63-31.08,10.89-9.46,7.26-17.87,18.4-25.21,33.41-1.47-7.5-3.71-14.03-6.73-19.58-3.02-5.54-6.57-10.16-10.65-13.83-4.08-3.67-8.53-6.4-13.34-8.2-4.81-1.79-9.91-2.69-15.3-2.69-11.26,0-21.78,3.76-31.57,11.26-9.79,7.51-18.27,19.17-25.45,35v-24.23c0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-36.47c-5.55,0-9.51,1.22-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97s1.18,10.52,3.55,12.97c2.36,2.45,6.32,3.67,11.87,3.67h20.07v159.56h-20.07c-5.55,0-9.51,1.23-11.87,3.67-2.37,2.45-3.55,6.77-3.55,12.97,0,1.95.13,3.69.36,5.27H0v1.12h88.34c.56,2.89,1.56,5.09,3,6.58,2.36,2.45,6.32,3.67,11.87,3.67h69.5c5.55,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h38.78c.56,2.89,1.56,5.09,3,6.58,2.36,2.45,6.32,3.67,11.87,3.67h35.24c5.54,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h37.56c.56,2.89,1.56,5.09,3,6.58,2.36,2.45,6.32,3.67,11.87,3.67h36.47c5.54,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h72.98c4.91,4.07,10.45,7.42,16.65,10.01,8.97,3.75,19.09,5.63,30.35,5.63,16.8,0,32.38-4.37,46.74-13.09,1.32-.8,2.6-1.67,3.89-2.54h34.29c.55,2.99,1.57,5.22,3.05,6.7,2.36,2.37,6.32,3.55,11.87,3.55h38.91c5.54,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h12.28v166.56h2.32v-166.56h43.03c.56,2.89,1.56,5.09,3,6.58,2.36,2.45,6.32,3.67,11.87,3.67h157.61c5.55,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h76.22c.56,2.89,1.56,5.09,3,6.58,2.36,2.45,6.32,3.67,11.87,3.67h69.5c5.54,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h38.78c.56,2.89,1.56,5.09,3,6.58,2.36,2.45,6.32,3.67,11.87,3.67h35.24c5.54,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h37.56c.56,2.89,1.56,5.09,3,6.58,2.36,2.45,6.32,3.67,11.87,3.67h36.47c5.54,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h72.98c4.91,4.07,10.45,7.42,16.65,10.01,8.97,3.75,19.09,5.63,30.35,5.63,16.8,0,32.38-4.37,46.74-13.09,1.32-.8,2.61-1.67,3.89-2.54h34.29c.55,2.99,1.57,5.22,3.05,6.7,2.36,2.37,6.32,3.55,11.87,3.55h38.91c5.54,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h57.63c.56,2.89,1.56,5.09,3,6.58,2.36,2.45,6.32,3.67,11.87,3.67h157.61c5.54,0,9.5-1.22,11.87-3.67,1.44-1.49,2.44-3.69,3-6.58h137.95v-1.12h-137.77ZM187.77,391.91c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.32-3.67-11.87-3.67h-12.73v-78.56c0-12.4,1.14-23.7,3.43-33.9,2.28-10.19,5.34-18.97,9.18-26.31,3.83-7.34,8.32-13.05,13.46-17.13,5.14-4.08,10.65-6.12,16.52-6.12,8.32,0,14.27,2.9,17.87,8.69,3.59,5.79,5.38,14.16,5.38,25.09v144.88c0,1.95.13,3.69.36,5.27h-38.42ZM291.54,391.91c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.33-3.67-11.87-3.67h-13.95v-78.56c0-12.4,1.14-23.7,3.43-33.9,2.28-10.19,5.34-18.97,9.18-26.31,3.83-7.34,8.32-13.05,13.46-17.13,5.14-4.08,10.65-6.12,16.52-6.12,8.32,0,14.27,2.9,17.87,8.69,3.59,5.79,5.38,14.16,5.38,25.09v144.88c0,1.95.13,3.69.36,5.27h-37.2ZM567.41,391.91c12.06-8.5,22.77-20.04,32.12-34.64v29.61c0,1.85.12,3.52.33,5.03h-32.45ZM1089.36,391.91c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.33-3.67-11.87-3.67h-12.72v-78.56c0-12.4,1.14-23.7,3.43-33.9,2.28-10.19,5.34-18.97,9.18-26.31,3.83-7.34,8.32-13.05,13.46-17.13,5.14-4.08,10.65-6.12,16.52-6.12,8.32,0,14.27,2.9,17.87,8.69,3.59,5.79,5.38,14.16,5.38,25.09v144.88c0,1.95.13,3.69.36,5.27h-38.42ZM1193.13,391.91c.23-1.58.37-3.32.37-5.27,0-6.2-1.19-10.52-3.55-12.97-2.37-2.45-6.33-3.67-11.87-3.67h-13.95v-78.56c0-12.4,1.14-23.7,3.43-33.9,2.28-10.19,5.34-18.97,9.18-26.31,3.83-7.34,8.32-13.05,13.46-17.13,5.14-4.08,10.65-6.12,16.52-6.12,8.32,0,14.28,2.9,17.87,8.69,3.59,5.79,5.39,14.16,5.39,25.09v144.88c0,1.95.13,3.69.36,5.27h-37.2ZM1469,391.91c12.06-8.5,22.77-20.04,32.12-34.64v29.61c0,1.85.12,3.52.33,5.03h-32.45Z"/>
  </svg>


  <canvas id="boids" width="150" height="150"></canvas>

<div id="controlPanel">
  <div class="section">
    <label>Constraint Type</label>
    <select id="constraintType">
      <option value="window">window</option>
      <option value="shape">shape</option>
      <option value="none">none</option>
    </select>
  </div>

  <div class="section">
    <label><input type="checkbox" id="drawTail"> Draw Tail</label>
    <label>Tail Colour</label>
    <input type="color" id="tailColour" />
    <label>Tail Width</label>
    <input type="number" id="tailWidth" min="0" step="0.1">
  </div>

  <div class="section">
    <label>Size</label>
    <input type="number" id="size" step="1">
    <label>Min Distance</label>
    <input type="number" id="minDistance" step="1">
    <label>Num Boids</label>
    <input type="number" id="numBoids" step="1">
  </div>

  <div class="section">
    <label>Visual Range</label>
    <input type="number" id="visualRange" step="1">
    <label>Centering Factor</label>
    <input type="number" id="centeringFactor" step="0.001">
    <label>Matching Factor</label>
    <input type="number" id="matchingFactor" step="0.01">
    <label>Avoid Factor</label>
    <input type="number" id="avoidFactor" step="0.01">
    <label>Speed Limit</label>
    <input type="number" id="speedLimit" step="1">
  </div>

  <div class="section">
    <label>Grid Size</label>
    <input type="number" id="gridSize" step="1">
    <label>Threshold</label>
    <input type="number" id="threshold" step="1">
  </div>
</div>
<script>
  console.log("Hello")

// Interface
   const bindings = {
    constraintType: val => constraintType = val,
    drawTail: val => drawTail = val,
    tailColour: val => tailColour = val,
    tailWidth: val => tailWidth = parseFloat(val),
    size: val => size = parseFloat(val),
    minDistance: val => minDistance = parseFloat(val),
    numBoids: val => numBoids = parseInt(val),
    visualRange: val => visualRange = parseFloat(val),
    centeringFactor: val => centeringFactor = parseFloat(val),
    matchingFactor: val => matchingFactor = parseFloat(val),
    avoidFactor: val => avoidFactor = parseFloat(val),
    speedLimit: val => speedLimit = parseFloat(val),
    gridSize: val => gridSize = parseInt(val),
    threshold: val => threshold = parseFloat(val),
  };

  console.log(bindings)

  // Set values in UI
  document.getElementById("constraintType").value = constraintType;
  document.getElementById("drawTail").checked = drawTail;
  document.getElementById("tailColour").value = tailColour;
  document.getElementById("tailWidth").value = tailWidth;
  document.getElementById("size").value = size;
  document.getElementById("minDistance").value = minDistance;
  document.getElementById("numBoids").value = numBoids;
  document.getElementById("visualRange").value = visualRange;
  document.getElementById("centeringFactor").value = centeringFactor;
  document.getElementById("matchingFactor").value = matchingFactor;
  document.getElementById("avoidFactor").value = avoidFactor;
  document.getElementById("speedLimit").value = speedLimit;
  document.getElementById("gridSize").value = gridSize;
  document.getElementById("threshold").value = threshold;

  // Wire input updates
  for (const id in bindings) {
    const el = document.getElementById(id);
    if (!el) continue;
    el.addEventListener("input", () => {
      const value = el.type === "checkbox" ? el.checked : el.value;
      bindings[id](value);
    });
  }

  // Dragging logic
  const panel = document.getElementById("controlPanel");
  console.log(panel)
  let isDragging = false, offsetX, offsetY;

  panel.addEventListener("mousedown", (e) => {
    if (e.target.tagName === 'INPUT' || e.target.tagName === 'SELECT') return;
    isDragging = true;
    offsetX = e.clientX - panel.offsetLeft;
    offsetY = e.clientY - panel.offsetTop;
  });

  document.addEventListener("mousemove", (e) => {
    if (isDragging) {
      panel.style.left = `${e.clientX - offsetX}px`;
      panel.style.top = `${e.clientY - offsetY}px`;
    }
  });

  document.addEventListener("mouseup", () => isDragging = false);


</script>
</body>

</html>